{% extends "base.html" %}
{% block content %}

<div id="container">
	<h1>Welcome to BounceHouse!</h1>
	<div class = "button-container">
		<p class="description">Sign in with Google+, Twitter, or Facebook to get started</p>
		<div class="connect" id="google-connect">
			<!-- 
				data-scope indicates access to user's data the app requires
				data-requestvisibleactions defines type of moments app is requesting to write
			-->
			<button class="g-signin"
				data-scope="https://www.googleapis.com/auth/plus.login"
				data-requestvisibleactions="http://schemas.google.com/AddActivity"
				data-clientId="{{ CLIENT_ID }}"
				data-accesstype="offline"
				data-callback="googleCallback"
				data-theme="dark"
				data-cookiepolicy="single_host_origin"
				data-width="300">
			</button>
		</div>
		<div class="connect" id="twitter-connect">
			<form action="http://ignore.ninja-bounce-house.appspot.com/twit/">
				<input type="image" src="https://dev.twitter.com/sites/default/files/images_documentation/sign-in-with-twitter-gray.png" />
			</form>
		</div>
		<div class="connect" id="facebook-connect">
			<fb:login-button scope="public_profile,email, publish_actions" onlogin="checkLoginState();">
			</fb:login-button>
			<div id="status"></div>
		</div>
	</div>

<div id="container">
	<div class="form-group">
		<label for="title">Text to post to facebook graph: </label>
		<input type="" class="form-control" id="TEXT_ID" placeholder="Enter post title" name="title" required>
	</div>
	<button onclick="PostText()" name="submit">Post</button>
</div>

<div id="container">
	<div class="form-group">
		<label for="title">Picture to post to facebook graph: </label>
		<input type="file" class="form-control" id="PIC_ID" placeholder="Enter pic" name="PicTitle" required>
	</div>
	<button onclick="PostPic()" name="submitPic">Post Pic</button>
</div>

	<div id="connected" class="not_visible">
		<p class="description" id="user-name"></p>
		<div id="google-connected" class="not_visible">
			<h4>Google +</h4>
			<a href="/moment">
				<button id="google-moment" class="btn btn-primary">Insert a moment</button>
			</a>
			<button id="google-disconnect" class="btn">Sign out</button>
		</div>
		<div id="facebook-connected" class="not_visible">
			<h4>Facebook</h4>
			<button class="btn btn-primary">Post to graph</button>
			<button class="btn">Sign out</button>
		</div>
		<div id="twitter-connected" class="not_visible">
			<h4>Twitter</h4>
			<button class="btn btn-primary">Upload a photo</button>
			<button class="btn">Sign out</button>
		</div>
		</div>
	</div>
</div>


<script type = "text/javascript">

    var authResult = undefined;

    function onSignInCallback(authResult) {
      if (authResult['access_token']) {     // the user is signed in
        console.log(authResult);

        // Hide the sign-in button
        $('#gConnect').hide('slow');

        this.authResult = authResult;
        connectServer();
      } else {
        console.log('Sign-in state: ' + authResult['error']);
      }
    }

    function connectServer() {
        console.log(authResult.code);
        // Ajax is a group of web development techniques used on the client-side
        // It creates asynchronous Web Applications 
        // They can send and retrieve data in background without interfering with the existing page
        $.ajax({
            type: 'POST',
            // the url to which the request is sent
            url: window.location.href + 'connect',
            // what is this?
            contentType: 'application/octet-stream; charset=utf-8',
            // a function to call if the request succeeds
            success: function(result) {                         
              console.log(result);
              $('#connected').show();
            },
            // prevents data from being transformed into a query string
            processData: false,
            // data to be sent to the server
            data: this.authResult.code
        });
    }

    function disconnectServer() {
        // redisplay the sign-in button
        $('#gConnect').show('slow');
        $('#connected').hide('slow');

        $.ajax({
            type: 'POST',
            url: window.location.href + 'disconnect',
            async: false,
            success: function(result) {
                console.log('revoke response: ' + result);
            },
            error: function(e) {
                console.log(e);
            }
        });
    }

    $(document).ready(function() {
        $('#gdisconnect').click(disconnectServer);
    });
</script>

<!DOCTYPE html>
<html>
<head>
<title>Facebook Login JavaScript Example</title>
<meta charset="UTF-8">
</head>
<body>
<script>

  function PostText()
{
	FB.api('/me/feed', 'post', {message: document.getElementById("TEXT_ID").value});
}
function PostPic()
{
    /*FB.api(
    "/me/photos",
    "POST",
    {
        "object": {
            "source": document.getElementById("PIC_ID").form
        }
    }
); */
}
</script>

<!--
  Below we include the Login Button social plugin. This button uses
  the JavaScript SDK to present a graphical Login button that triggers
  the FB.login() function when clicked.
-->




</body>
</html>

<script src="{{ url_for('static', filename='js/gplus.js') }}"></script>
<script src="{{ url_for('static', filename='js/plusone.js') }}"></script>
<script src="{{ url_for('static', filename='js/facebook.js') }}"></script>

{% endblock %}
